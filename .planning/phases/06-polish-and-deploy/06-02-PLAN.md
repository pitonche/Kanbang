---
phase: 06-polish-and-deploy
plan: 02
type: execute
wave: 2
depends_on: ["06-01"]
files_modified:
  - vercel.json
autonomous: false

user_setup:
  - service: convex
    why: "Production deployment requires a deploy key from Convex dashboard"
    env_vars:
      - name: CONVEX_DEPLOY_KEY
        source: "Convex Dashboard -> Project Settings -> Production Deploy Key (generate if none exists)"
    dashboard_config:
      - task: "Ensure a production deployment exists"
        location: "Convex Dashboard -> Project Settings -> Deployments"

must_haves:
  truths:
    - "App is deployed to Vercel and accessible via a public URL"
    - "Convex backend is connected to the deployed frontend"
    - "SPA routing works without 404 on page refresh"
  artifacts:
    - path: "vercel.json"
      provides: "SPA rewrite rules for Vercel"
      contains: "rewrites"
  key_links:
    - from: "vercel.json"
      to: "Vercel hosting"
      via: "SPA rewrite rule"
      pattern: "destination.*index.html"
    - from: "Vercel build command"
      to: "Convex production deployment"
      via: "npx convex deploy --cmd"
      pattern: "CONVEX_DEPLOY_KEY"
---

<objective>
Deploy the Kanbang app to Vercel with Convex backend connected and SPA routing configured.

Purpose: DEPL-01 -- App is deployed to Vercel and accessible via URL.
Output: vercel.json for SPA routing, GitHub repository, Vercel deployment with public URL.
</objective>

<execution_context>
@/Users/ciciban/.claude/get-shit-done/workflows/execute-plan.md
@/Users/ciciban/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-polish-and-deploy/06-RESEARCH.md
@.planning/phases/06-polish-and-deploy/06-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create vercel.json and prepare for deployment</name>
  <files>vercel.json</files>
  <action>
Create vercel.json at the project root with SPA rewrite rules so direct URL access or page refresh does not 404:

```json
{
  "$schema": "https://openapi.vercel.sh/vercel.json",
  "rewrites": [
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ]
}
```

This ensures all routes fall through to index.html, which is standard for Vite SPAs on Vercel.

Then create a GitHub repository and push the code:
1. Run `cd /Volumes/Backup/PRIVATE/GSD/Kanbang && git remote -v` to check if a remote already exists.
2. If no remote: run `gh repo create Kanbang --public --source=. --remote=origin --push` to create the repo, add the remote, and push all code.
3. If remote exists: run `git push origin main` to push latest code.

Note: The `gh` CLI must be authenticated. If auth fails, this becomes a checkpoint for the user.
  </action>
  <verify>Run `git remote -v` to confirm origin is set. Run `git log --oneline -1 origin/main` to confirm code is pushed. Verify vercel.json exists with `cat vercel.json`.</verify>
  <done>vercel.json exists with SPA rewrite rules. Code is pushed to GitHub repository.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Deploy to Vercel and verify live URL</name>
  <what-built>GitHub repository created with all Kanbang code pushed. vercel.json SPA rewrites configured. The app is ready for Vercel deployment.</what-built>
  <how-to-verify>
1. Go to https://vercel.com/new and import the Kanbang GitHub repository
2. In Build & Development Settings, set the Build Command to: `npx convex deploy --cmd 'npm run build'`
3. In Environment Variables, add:
   - `CONVEX_DEPLOY_KEY` = your production deploy key from Convex Dashboard -> Project Settings -> Production Deploy Key
4. Click Deploy
5. Once deployed, visit the public URL and verify:
   - The Kanban board loads with all 6 columns
   - Tasks can be created, edited, dragged between columns
   - Search and cadence filters work
   - Archive view is accessible
   - Page title shows "Kanbang" in the browser tab
  </how-to-verify>
  <resume-signal>Provide the deployed URL and type "approved", or describe any deployment issues</resume-signal>
</task>

</tasks>

<verification>
1. vercel.json exists at project root with SPA rewrite rules
2. GitHub repository exists with all code pushed
3. App is deployed to Vercel and loads at a public URL
4. Convex backend is connected (tasks load from database)
5. All features work on the deployed version
</verification>

<success_criteria>
- vercel.json is in place with SPA rewrites
- Code is pushed to GitHub
- App is deployed to Vercel with a public URL
- Convex production backend is connected and functional
- User confirms the deployed app works
</success_criteria>

<output>
After completion, create `.planning/phases/06-polish-and-deploy/06-02-SUMMARY.md`
</output>
